<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>DESC registration form</title>

  <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css'>
  <link rel='stylesheet prefetch' href='https://fonts.googleapis.com/css?family=Raleway:400,400i,700'>
  <style>
    body {
      margin-top: 2%;
      margin-bottom: 0px;
      /* Margin bottom by footer height */
    }

    .outer {
      width: 1000px;
      margin: 0 auto;
    }

    .inner {
      margin-left: 5%;
    }

    .footer {
      margin-top: 40px;
      width: 100%;
      background-color: #f5f5f5;
    }

    #registrationModal .modal-dialog {
      width: 1000px;
      max-width: 2048px;
    }

    .embed-responsive {
      max-height: calc(100vh - 225px);
    }

    /*
#registrationModal .modal-footer {
  justify-content: space-between;
} */
  </style>

</head>

<body>
  <div class="container">
    <h2>Registration for the October 2021 DESC Sprint Week</h2>
    <h4>Sunday - Friday, October 24 - October 29, 2021</h4>
    There is no registration fee for this meeting.
    <br>
    Please join the LSSTC Slack channel <a href="https://lsstc.slack.com/archives/C90AMAG80" target="_blank">#desc-collab-meeting</a> to keep updated on chats, discussions, and announcements during the meeting.
    <br>
    You can find the the details of the schedule on this <a href="https://confluence.slac.stanford.edu/x/OKmREg" target="_blank">confluence page</a>.
    <br>
    <br>
    <form action="" method="POST" id="main_form">
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="first_name">First Name</label>
          <input type="text" class="form-control" name="first_name" id="first_name" placeholder="First Name" maxlength="100" required>
          <div class="invalid-feedback">Please provide your first name.</div>
        </div>
        <div class="form-group col-md-6">
          <label for="last_name">Last Name</label>
          <input type="text" class="form-control" name="last_name" id="last_name" placeholder="Last Name" maxlength="100" required>
          <div class="invalid-feedback">Please provide your last name.</div>
        </div>
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" class="form-control" name="email" id="email" placeholder="Email" maxlength="100" required>
        <div class="invalid-feedback">
          Invalid email or already registered.
        </div>
      </div>
      <div class="form-group">
        <label for="affili">Affiliation</label>
        <input type="text" class="form-control" name="affiliation" id="affili" placeholder="Affiliation" maxlength="100" required>
        <div class="invalid-feedback">Please provide your affiliation.</div>
      </div>

      <hr>
      <h5>DESC Meeting Contact Persons</h5>

      As described in the <a href="https://lsstdesc.org/sites/default/files/LSST_DESC_Professional_Conduct.pdf#page=6" target="_blank">DESC Meeting Contact Person Policy</a>, Meeting Contact Persons (MCPs) will be available to
      meeting participants and be afforded the authority to take action to resolve disputes, conflicts, or harmful situations.
      MCPs will be selected from eligible participants, and be appointed by the Collaboration Council and the Management Team. All MCP appointments will be confirmed and scheduled with candidates before the meeting.

      <div class="form-group">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="contact" name="contact">
          <label class="form-check-label" for="contact">
            <b>Check if you do NOT wish to be considered for the role of an MCP.</b>
          </label>
        </div>
      </div>


      <hr>
      <h5>Session Facilitators</h5>
      You (as a meeting participant) can help ensure the success of this meeting by enrolling as a Session Facilitator for one or two sessions. For a quick look at what's involved, see the
      <a href='https://docs.google.com/document/d/1HRU_1hApNuvmBxBLkygH54-EvGmfl2emlYinQrvppzs/edit?usp=sharing'>Session Facilitator's Cheat Sheet</a>.
        New/junior members are especially encouraged to take advantage of this opportunity as it will help gain familiarity within the DESC community.
      <div class="form-group">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="volunteer" name="volunteer">
          <label class="form-check-label" for="volunteer">
            <b>Yes, I definitely want to help out!</b>
          </label>
        </div>
      </div> 
     <hr>
<!--

      <div class="form-group">
      <label for="volunteer_responsibilities">Also, if you have preferred facilitator responsibilities or sessions you'd like to join, please mention them briefly here.</label>
      <input type="text" class="form-control" name="volunteer_responsibilities" id="volunteer_responsibilities" placeholder="e.g. blending-related sessions, plenaries" maxlength="200">
      </div>
-->

      <hr>
<div class="outer">
    <div class="inner">
      <div class="form-group">
      <label for="wg_sessions">If you signed up to be a Session Facilitator, please indicate potential session topics for which you would be interested in facilitating a session. We will try our best to match your preference when possible.</label>
      <div id="wg_sessions">
      <div class="form-check form-check-inline" id="wg_sessions">
        <input class="form-check-input" type="checkbox" name="CL" id="CL">
        <label class="form-check-label" for="CL">CL: Clusters of Galaxies</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="LSS" id="LSS">
        <label class="form-check-label" for="LSS">LSS: Large Scale Structure</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox"  name="SL" id="SL">
        <label class="form-check-label" for="SL">SL: Strong Lensing</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox"  name="SN" id="SN">
        <label class="form-check-label" for="SN">SN: Supernova</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="WL" id="WL">
        <label class="form-check-label" for="WL">WL: Weak Lensing</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="BL" id="BL">
        <label class="form-check-label" for="BL">BL: Blending</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="CO" id="CO">
        <label class="form-check-label" for="CO">CO: Computing</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="COM" id="COM">
        <label class="form-check-label" for="COM">COM: Commissioning</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="CSS" id="CSS">
        <label class="form-check-label" for="CSS">CSS: Cosmology and Survey Simulations</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="DKM" id="DKM">
        <label class="form-check-label" for="DKM">DKM: Dark Matter</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="ES" id="ES">
        <label class="form-check-label" for="ES">ES: External Synergies</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="OS" id="OS">
        <label class="form-check-label" for="OS">OS: Observing Strategy</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="PC" id="PC">
        <label class="form-check-label" for="PC">PC: Photometric Corrections</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="PSF" id="PSF">
        <label class="form-check-label" for="PSF">PSF: Point Spread Function</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="PZ" id="PZ">
        <label class="form-check-label" for="PZ">PZ: Photometric Redshifts</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="SA" id="SA">
        <label class="form-check-label" for="SA">SA: Sensor Anomalies</label>
      </div>

      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="TJP" id="TJP">
        <label class="form-check-label" for="TJP">TJP: Theory & Joint Probes</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="Social" id="Social">
        <label class="form-check-label" for="Social">Social Events</label>
      </div>
        </div>
    </div>
    </div>
  </div>

      <hr>
      <h5>Mentor/Mentee Sign-Up</h5>
      <p>We all know how challenging it can be to navigate a new space,
        with a lot of things happening during DESC meeting and in the large DESC collaboration in general.
        To address this, the LOC will set up mentor/mentee pairs with the overarching goal of the effort
        to have a point of contact for attendees who might not know where to start.
        Typically, the role of a mentor will simply be to be available and open to
        fielding questions and directing mentees to the right resources (people and/or documentation).
        Junior members who have experience of DESC meetings are encouraged to consider this opportunity of being a mentor!<br>
        So:
      </p>
      <ul>
        <li> If you are new to DESC meetings and/or would like some guidance on how
          to make the most out of this meeting, <b> would you like to be a mentee </b> and have a friendly mentor for the DESC 2021 October Sprint Week?
          <div class="form-group">
            <div>
              <div class="form-check form-check-inline" id="inputMentee">
                <input class="form-check-input" type="checkbox" name="mentee" id="mentee_yes" value="yes">
                <label class="form-check-label" for="mentee_yes">Sign me up!</label>
              </div>
            </div>
          </div>
        </li>

        <li> If you know your way around DESC and/or have attended DESC meetings,
          <b> would you like to be a friendly mentor</b> for the DESC 2021 October Sprint Week?
          <div class="form-group">
            <div>
              <div class="form-check form-check-inline" id="inputMentor">
                <input class="form-check-input" type="checkbox" name="mentor" id="mentor_yes" value="yes">
                <label class="form-check-label" for="mentor_yes">Sign me up!</label>
              </div>
            </div>
          </div>
        </li>

      </ul>
    <hr>
    <h5>Accommodations</h5>
    <p>If you require any additional accommodations during the meeting, please fill out
    <a href="https://forms.gle/eBMAa3yDrwxJqvia7">this form</a>.
    </p>

    <hr>
    <div class="form-group">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="code_of_conduct" id="code_of_conduct" required>
        <label class="form-check-label" for="code_of_conduct">
        I have read, and will abide by, the <a href="https://lsstdesc.org/assets/pdf/policies/LSST_DESC_Professional_Conduct.pdf" target="_blank">DESC Meeting Code of Conduct</a>.
      </label>
          <div class="invalid-feedback">You must agree to the code of conduct before registering.</div>
      </div>
    </div>
    <div class="form-group" id="register_button">
      <button id="register" class="btn btn-primary" type="button">Register</button>
      <small class="form-text text-muted">Please disable ad or pop-up blockers if you encounter any difficulties with completing the registration.</small>
  </div>
    <input type="hidden" name="secret" id="secret" value=""/>
  </form>
</div>

  <!-- Modal Warning-->
  <div class="modal fade" id="backendModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Invalid registration URL</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>The URL for this form does not contain a valid registration link.
            Please contact the Logistics Organizing Committee (LOC) for a valid registration URL.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div class="modal fade" id="confirmationModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Registration successful</h5>
        </div>
        <div class="modal-body" id="confirmation-content">
        </div>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <dl class="row">
        <span class="text-muted">
          <p class="lead">Privacy notice</p>
          <p>Your <mark>first name, last name, and affiliation will appear on a public <a href="https://desc-july2021-meeting.herokuapp.com" target="_blank"> webpage </a> </mark> linked in the meeting's confluence participants page. Your email will be used to contact you when necessary. All data collected here may be shared with LSST DESC
            members who are on the Logistics Organizing Committee (LOC), the Scientific Organizing Committee (SOC), the Meetings Committee, the Collaboration Council, and the Management Team.
          </p>
      </dl>
    </div>
  </footer>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js'></script>
  <script>
    // Callback to validate registration
    var checkoutCallback = function() {
      // Manually submit form data using Ajax and display confirmation modal
      $.ajax({
        type: 'POST',
        data: $("#main_form").serialize(),
        url: $("#main_form").attr('action'),
        success: function(data) {
          $("#confirmation-content").html(data);
          $("#confirmationModal").modal({
            show: true,
            backdrop: 'static',
            keyboard: false
          });
        }
      });

    };

    document.getElementById("register").onclick = function(e) {
      checkoutCallback()

      e.preventDefault();
      return false;
    }

    // Validate the form before authorising checkout
    $(function() {
      document.getElementById("register_button").addEventListener("click", function(event) {
        var form = document.getElementById("main_form");

        // If form is not validated, don't trigger the registration
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, true);
    });

    // Function to disable the form if the backend is unavailable
    var getUrlParameter = function getUrlParameter(sParam) {
      var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

      for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
          return sParameterName[1] === undefined ? true : sParameterName[1];
        }
      }
    };

    var backend = getUrlParameter('backend');
    var secret = getUrlParameter('secret');

    $(function() {
      // Disable the form if the required info about backend server is missing
      if ((backend === undefined) || (secret === undefined)) {
        $("#main_form :input").prop('disabled', true);
        $('#backendModal').modal({
          show: true,
          backdrop: 'static',
          keyboard: false
        });
      }
      $("#main_form").attr('action', backend + '/register');
      $("#secret").attr('value', secret);
    });

    $("#email").change(function() {
      $.post(backend + "/check_email", {
          email: $(this).val(),
          secret: secret
        },
        function(data, status) {
          var d = document.getElementById("email");
          if (status === "success") {
            if (data === "Ok") {
              d.setCustomValidity("");
              d.classList.remove('is-invalid');
            } else {
              d.setCustomValidity("Already registered.");
              d.classList.add('is-invalid');
            }
          } else {
            // Server is unavailable...
            // make sure we don't block the form at this stage
            d.setCustomValidity("");
            d.classList.remove('is-invalid');
          }
          console.log("Data: " + data + "\nStatus: " + status);
        });
    });

    $("input").keyup(function() {
      var target = $("#" + $(this).attr("id") + "-s");
      target.text($(this).val());
      target.css("font-size", "100%");
      var badge = $("#badge");
      var scale = badge.width() / target.width();
      if (scale < 1) target.css("font-size", (scale * 100).toString() + "%");
    });
  </script>

</body>

</html>
