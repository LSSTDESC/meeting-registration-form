<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>DESC Sprint Week registration form</title>

  <link rel='stylesheet prefetch'
    href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css'>
  <link rel='stylesheet prefetch' href='https://fonts.googleapis.com/css?family=Raleway:400,400i,700'>
  <style>
    body {
      margin-top: 2%;
      margin-bottom: 0px;
      /* Margin bottom by footer height */
    }

    .outer {
      width: 1000px;
      margin: 0 auto;
    }

    .inner {
      margin-left: 5%;
    }

    .footer {
      margin-top: 40px;
      width: 100%;
      background-color: #f5f5f5;
    }

    #registrationModal .modal-dialog {
      width: 1000px;
      max-width: 2048px;
    }

    .embed-responsive {
      max-height: calc(100vh - 225px);
    }

    /*
#registrationModal .modal-footer {
  justify-content: space-between;
} */

    /* Hides the badge and in-person info until people
   sign up for in-person attendance.
 */
    /* #in_person_info {
      display: none;
    } */

    #volunteer_section {
      display: none;
    }

    #badge span {
      font-family: "Raleway";
    }

    #badge {
      position: relative;
      margin: 0 auto;
      width: 4in;
      height: 3in;
      border: 1px solid black;
    }

    #badge div {
      white-space: nowrap;
      text-align: center;
      width: 100%;
      position: absolute;
      line-height: 0.8;
    }

    #lname-d,
    #sname-d {
      font-weight: bold;
    }

    #lname-d {
      font-size: 68pt;
      bottom: 2.05in;
    }

    #sname-d {
      font-size: 26pt;
      font-weight: bold;
      bottom: 1.55in;
    }

    #affili-d,
    #pronoun-d {
      font-size: 22pt;
      bottom: 1.08in;
    }

    #pronoun-d {
      font-style: italic;
      bottom: 0.64in;
    }

    #event-d,
    #location-d {
      font-size: 7pt;
      bottom: 0.29in;
      left: 0.025in;
    }

    #location-d {
      bottom: 0.15in;
    }

    #logo1 {
      width: 92px !important;
      height: 61px;
      background-image: url("https://raw.githubusercontent.com/LSSTDESC/name-tag-guru/master/web-static/desc-logo.png");
      bottom: 0.02in;
      left: 0.1in;
    }

    #logo2 {
      width: 64px !important;
      height: 22px;
      background-image: url("https://raw.githubusercontent.com/LSSTDESC/meeting-registration-form/master/assets/logo-kipac_0_0.png");
      bottom: 0.15in;
      right: 0.2in;
    }
  </style>

</head>

<body>
  <div class="container">
    <h2>Registration for the 2024 DESC Sprint Week at SLAC</h2>
    <h4>Monday October 28 - Friday, November 1, 2024</h4>
    
    <mark><b>Registration for the Sprint Week is free</b>, the organizers thank the <a href="https://kipac.stanford.edu/" target="_blank"> Kavli Institute for Particle Astrophysics and Cosmology</a> for funding the event, covering all event costs.</mark>
    
  
    <br>
    <br>
    Please join the LSSTC Slack channel <a href="https://lsstc.slack.com/messages/C2M8FG5A6" target="_blank">#desc-hack-sprint</a> to keep updated on chats, discussions, and announcements during the meeting!
    <br>
    You can find the the details of the schedule on this <a href="https://confluence.slac.stanford.edu/URL-for-schedule-page"
      target="_blank">confluence page</a>.
    <br>
    <br>
    <form action="" method="POST" id="main_form">
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="first_name">First Name</label>
          <input type="text" class="form-control" name="first_name" id="first_name" placeholder="First Name"
            maxlength="100" required>
          <div class="invalid-feedback">Please provide your first name.</div>
        </div>
        <div class="form-group col-md-6">
          <label for="last_name">Last Name</label>
          <input type="text" class="form-control" name="last_name" id="last_name" placeholder="Last Name"
            maxlength="100" required>
          <div class="invalid-feedback">Please provide your last name.</div>
        </div>
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" class="form-control" name="email" id="email" placeholder="Email" maxlength="100" required>
        <div class="invalid-feedback">
          Invalid email or already registered.
        </div>
      </div>
      <div class="form-group">
        <label for="affili">Affiliation</label>
        <input type="text" class="form-control" name="affiliation" id="affili" placeholder="Affiliation" maxlength="100"
          required>
        <div class="invalid-feedback">Please provide your affiliation.</div>
      </div>

      <hr>
      <h5>LSST/DESC Membership</h5>
      Are you currently a member of the Dark Energy Science Collaboration? This info will allow us to better make accommodations for non-DESC attendees.
      <div class="form-group">
        <div class="form-check">
          <input class="form-check-input" type="radio" id="member" name="descmember" value="yes" required>
          <label class="form-check-label" for="descmember">
            <b>Yes</b>
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" id="nonmember" value="no" name="descmember">
          <label class="form-check-label" for="descmember">
            <b>No</b>
          </label>
        </div>
      </div>

      <hr>

      <h5>In-person or Remote?</h5>
      <div class="form-group">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="in_person" name="in_person">
          <label class="form-check-label" for="in_person">
            <b>Check if you plan to attend in person</b>
          </label>
        </div>
      </div>

      <!-- This entire block is hidden until people click the in-person attendance button -->
      <div id="in_person_info">

        <div class="row">
          <div class="col-sm">
            <div class="form-group">
              <label for="lname">Large-font name</label>
              <input type="text" class="form-control" name="lname" id="lname"
                placeholder="optional, defaults to first name" maxlength="100">
            </div>
            <div class="form-group">
              <label for="sname">Small-font name</label>
              <input type="text" class="form-control" name="sname" id="sname"
                placeholder="optional, defaults to last name" maxlength="100">
            </div>
            <div class="form-group">
              <label for="pronoun">Third-person pronoun</label>
              <input type="text" class="form-control" name="pronoun" id="pronoun"
                placeholder="e.g. she/her, he/him, they/them" maxlength="100">
              <small id="inputPronounHelp" class="form-text text-muted">Third-person pronoun you want people to use to
                refer to you, such as: they/she/he/ze, or simply just your names.
                You can also say "no preference" or just enter a space. <a
                  href="https://confluence.slac.stanford.edu/display/LSSTDESC/Personal+Pronouns" target="_blank">Why ask
                  for pronouns ?</a></small>
              <div class="invalid-feedback">Please provide your choice of pronoun.</div>
            </div>
          </div>
          <div class="col-sm">
            <div id="badge">
              <div id="lname-d">
                <span id="lname-s"></span>
              </div>
              <div id="sname-d">
                <span id="sname-s"></span>
              </div>
              <div id="affili-d">
                <span id="affili-s"></span>
              </div>
              <div id="pronoun-d">
                <span id="pronoun-s"></span>
              </div>
              <div id="event-d">
                <span id="event-s">DESC Sprint Week, Oct. 28 - Nov. 1, 2024</span>
              </div>
              <div id="location-d">
                <span id="location-s">SLAC</span>
              </div>
              <div id="logo1" class="logo"></div>
              <div id="logo2" class="logo"></div>
            </div>
          </div>
        </div>



        <div class="container">

          <h5>Covid-19 guidelines</h5>

          <p>To ensure the safety of the meeting, in-person participants are asked to follow the following guidelines for this event: 
            <ul>
              <li><b>If you have tested positive for Covid-19</b>: Please follow <a href="https://www.cdc.gov/coronavirus/2019-ncov/your-health/isolation.html" target="_blank">CDC guidelines</a> on isolation and masking. </li>
              <li><b>Facial Coverings</b>: Facial coverings both indoors and outdoors are optional. </li>
            </ul>
            </p>

          <div class="form-group">
            
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="covid_rules" id="covid_rules">
              <label class="form-check-label" for="covid_rules">
                I agree to abide by the Covid-19 related rules at the venue at the time of the meeting.
              </label>
              <div class="invalid-feedback">You must agree to follow the Covid-19 rules.</div>
            </div>
	    <!--
            <small class="form-text text-muted">
              For the current Covid-19-related information at CMU, see: <a href="https://www.cmu.edu/coronavirus/"
                target="_blank" rel="noopener noreferrer">https://www.cmu.edu/coronavirus/</a>.
            </small>
	    -->

          </div>


        <hr>
      
        <h5>Attendance</h5>
        Please check which days you plan on attending. Lunch will be provided on those days.
        <div class="form-group">
  
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="monday" name="monday">
            <label class="form-check-label" for="monday">
              Monday, October 28.
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="tuesday" name="tuesday">
            <label class="form-check-label" for="tuesday">
              Tuesday, October 29.
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="wednesday" name="wednesday">
            <label class="form-check-label" for="wednesday">
              Wednesday, October 30.
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="thursday" name="thursday">
            <label class="form-check-label" for="thursday">
              Thursday, October 31.
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="friday" name="friday">
            <label class="form-check-label" for="friday">
              Friday, Novermber 1.
            </label>
          </div>
        </div> <!-- form group -->
  

          <h5>Dietary restrictions</h5>
            <div class="form-group">
              <label for="dietary">
                Please describe any dietary restrictions.</label>
              <input class="form-control" type="text" id="dietary" name="dietary" maxlength="200"
                placeholder="Dietary restrictions">
            </div>

      </div>
      </div>
      

      <hr>
      <h5>DESC Meeting Contact Persons</h5>

      As described in the <a href="https://lsstdesc.org/sites/default/files/LSST_DESC_Professional_Conduct.pdf#page=6"
        target="_blank">DESC Meeting Contact Person Policy</a>, Meeting Contact Persons (MCPs) will be available (by
      Zoom and Slack) to
      meeting participants and be afforded the authority to take action to resolve disputes, conflicts, or harmful
      situations.
      MCPs will be selected from eligible participants, and be appointed by the Collaboration Council and the Management
      Team. All MCP appointments will be confirmed and scheduled with candidates before the meeting.

      <div class="form-group">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="contact" name="contact">
          <label class="form-check-label" for="contact">
            <b>Check if you do NOT wish to be considered for the role of an MCP.</b>
          </label>
        </div>
      </div>

      <hr>
      <h5>Junior Membership and Mentor/Mentee Sign-Up</h5>
      <p>We all know how challenging it can be to navigate a new space,
        with a lot of things happening during DESC meetings and in the large DESC collaboration in general.
        To address this, the LOC will set up mentor/mentee pairs with the overarching goal of having
        a point of contact for attendees who might not know where to start.
        Typically, the role of a mentor will simply be to be available and open to
        fielding questions and directing mentees to the right resources (people and/or documentation).
        Junior members who have experience with DESC meetings are encouraged to consider serving as a mentor!
      <br> <br>
       Please indicate your experience with the DESC collaboration and your
       interest in the mentorship program below.
      </p>
      <ul>

          <div class="form-group">
            <div>
              <div class="form-check form-check-inline" id="inputJudo">
                <input class="form-check-input" type="checkbox" name="judo" id="judo" value="yes">
                <label class="form-check-label" for="judo">I'm an early-career scientist or am new to the DESC collaboration.</label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <div>
              <div class="form-check form-check-inline" id="inputMentee">
                <input class="form-check-input" type="checkbox" name="mentee" id="mentee_yes" value="yes">
                <label class="form-check-label" for="mentee_yes">I'd like to be paired with a mentor for the DESC 2024 Sprint Week!</label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <div>
              <div class="form-check form-check-inline" id="inputMentor">
                <input class="form-check-input" type="checkbox" name="mentor" id="mentor_yes" value="yes">
                <label class="form-check-label" for="mentor_yes">I'd like to be a mentor for the DESC 2024 Sprint Week!</label>
              </div>
            </div>
          </div>

      </ul>

      <hr>
      <h5>A/V Accommodations</h5>
      <p>If you require any additional accommodations (e.g., closed captions,
        alt-text for screen readers, etc), please fill out
        <a href="https://forms.gle/Mj7qR4qs9ToB9vRT6">this
          anonymous form</a>.
      </p>

      <hr>
      <div class="form-group">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="recording" id="recording" required>
          <label class="form-check-label" for="recording">
            Some sessions (e.g. tutorials) will be recorded and recordings will be posted to DESC Confluence. As a presenter
            or participant of the meeting, I understand that what I say, with my microphone turned on, may be recorded.
            (All participants will be informed in Zoom when they are joining a session that is being recorded.
            Organizers of Zoom sessions will be asked to consider the preferences of the speakers. If you prefer
            your image not to appear, you are welcome to keep your video turned off.)
          </label>
          <div class="invalid-feedback">Please acknowledge that you may be recorded.</div>
        </div>
      </div>
      <div class="form-group">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="code_of_conduct" id="code_of_conduct" required>
          <label class="form-check-label" for="code_of_conduct">
            I have read, and will abide by, the <a
              href="https://lsstdesc.org/assets/pdf/policies/LSST_DESC_Professional_Conduct.pdf" target="_blank">DESC
              Meeting Code of Conduct</a>.
          </label>
          <div class="invalid-feedback">You must agree to the code of conduct before registering.</div>
        </div>
      </div>
      <div class="form-group" id="register_button">
        <button id="register" class="btn btn-primary" type="button">Register</button>
        <small class="form-text text-muted">Please disable ad or pop-up blockers if you encounter any difficulties with
          completing the registration.</small>
      </div>
      <input type="hidden" name="secret" id="secret" value="">
    </form>
  </div>

  <!-- Modal Warning-->
  <div class="modal fade" id="backendModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Invalid registration URL</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>The URL for this form does not contain a valid registration link.
            Please contact the Logistics Organizing Committee (LOC) for a valid registration URL.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="registrationClosedModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Registration is closed</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
<!--
        <div class="modal-body">
          <p>The registration for this event is now closed.
            Please contact the LOC if you have any further inquiries.</p>
        </div>
-->
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div class="modal fade" id="confirmationModal" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Your Registration Information Has Been Received</h5>
        </div>
        <div class="modal-body" id="confirmation-content">
        </div>
      </div>
    </div>
  </div>


  <footer class="footer">
    <div class="container">
      <dl class="row">
        <span class="text-muted">
          <p class="lead">Privacy notice</p>
          <p>Your <mark>first name, last name, and affiliation will appear on a public <a
                href="https://desc-aug2022-meeting.herokuapp.com" target="_blank"> webpage </a> </mark> linked in the
            meeting's confluence participants page. Your email will be used to contact you when necessary. All data
            collected here may be shared with LSST DESC
            members who are on the Logistics Organizing Committee (LOC), the Scientific Organizing Committee (SOC), the
            Meetings Committee, the Collaboration Council, and the Management Team.
          </p>
      </dl>
    </div>
  </footer>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js'></script>
  <script>
    // Callback to validate registration
    var checkoutCallback = function () {
      // Manually submit form data using Ajax and display confirmation modal
      $.ajax({
        type: 'POST',
        data: $("#main_form").serialize(),
        url: $("#main_form").attr('action'),
        success: function (data) {

          // Registration successful so far, so let's proceed to payment
          $("#confirmation-content").html(data);
          $("#confirmationModal").modal({
            show: true,
            backdrop: 'static',
            keyboard: false
          });
        }
      });

    };

    document.getElementById("register").onclick = function (e) {
      checkoutCallback()

      e.preventDefault();
      return false;
    }

    // Validate the form before authorising checkout
    $(function () {
      document.getElementById("register_button").addEventListener("click", function (event) {
        var form = document.getElementById("main_form");

        // If form is not validated, don't trigger the registration
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, true);
    });

    // Function to disable the form if the backend is unavailable
    var getUrlParameter = function getUrlParameter(sParam) {
      var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

      for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
          return sParameterName[1] === undefined ? true : sParameterName[1];
        }
      }
    };

    var backend = getUrlParameter('backend');
    var secret = getUrlParameter('secret');

    $(function () {
      // Disable the form if the required info about backend server is missing
      if ((backend === undefined) || (secret === undefined)) {
        $("#main_form :input").prop('disabled', true);
        $('#backendModal').modal({
          show: true,
          backdrop: 'static',
          keyboard: false
        });
      };
      // }else{
      // // To close registration
      //   $("#main_form :input").prop('disabled', true);
      //   $('#registrationClosedModal').modal({
      //     show: true,
      //     backdrop: 'static',
      //     keyboard: false
      //   });
      // }

      $("#main_form").attr('action', backend + '/register');
      $("#secret").attr('value', secret);
    });

    $("#email").change(function () {
      $.post(backend + "/check_email", {
          email: $(this).val(),
          secret: secret
        },
        function (data, status) {
          var d = document.getElementById("email");
          if (status === "success") {
            if (data === "Ok") {
              d.setCustomValidity("");
              d.classList.remove('is-invalid');
            } else {
              d.setCustomValidity("Already registered.");
              d.classList.add('is-invalid');
            }
          } else {
            // Server is unavailable...
            // make sure we don't block the form at this stage
            d.setCustomValidity("");
            d.classList.remove('is-invalid');
          }
          console.log("Data: " + data + "\nStatus: " + status);
        });
    });

    $("input").keyup(function () {
      var target = $("#" + $(this).attr("id") + "-s");
      target.text($(this).val());
      target.css("font-size", "100%");
      var badge = $("#badge");
      var scale = badge.width() / target.width();
      if (scale < 1) target.css("font-size", (scale * 100).toString() + "%");
    });

    $(document).ready(function () {
      $('#in_person').click(function () {
        $('#in_person_info').toggle(500);

        if (document.getElementById("in_person").checked) {
          document.getElementById("pronoun").required = true;
          document.getElementById("covid_vaccine").required = true;
          document.getElementById("covid_rules").required = true;


        } else {
          document.getElementById("pronoun").required = false;
          document.getElementById("covid_vaccine").required = false;
          document.getElementById("covid_rules").required = false;

        };

      });
    });

    $(document).ready(function () {
      $('#volunteer').click(function () {
        $('#volunteer_section').toggle(500);
      });
    });
  </script>

</body>

</html>
