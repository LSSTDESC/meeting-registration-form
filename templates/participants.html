<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>DESC meeting participants</title>
  <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.css'>

</head>

<body>
  <div class="container">
    <!-- <h2>LSST DESC Meeting participants</h2> -->
    <!-- <br> -->
    Total interested participants: {{data|length}}
    <div id="APC_confirmed">Confirmed APC participants: 0</div>
    <div id="UIUC_confirmed">Confirmed UIUC participants: 0</div>
    <div id="Princeton_confirmed">Confirmed Princeton participants: 0</div>
    <div id="Remote_confirmed">Confirmed remote participants: 0</div>
    <br>
    <table class="table table-hover" onload="checkConfirmed({{data}})">
      <thead class="thead-light">
        <tr>
          <th scope="col">First Name</th>
          <th scope="col">Last Name</th>
          <th scope="col">Affiliation</th>
          <th scope="col">Attendance Confirmed?</th>
        </tr>
      </thead>
      <tbody>
        {% for item in data %}
        <tr>
          <td>{{item.first_name}}</td>
          <td>{{item.last_name}}</td>
          <td>{{item.affiliation}}</td>
          <td>{{item.confirmed}}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

<script>
function checkConfirmed(data){
  window.alert("We're actually using the function!");
  window.alert(data.length);
  var sumAPC = 0;
  var sumUIUC = 0;
  var sumPrinceton = 0;
  var sumRemote = 0;
  for (let i=0; i<data.length;i++){
    window.alert(data[i].confirmed);
	if (data[i].confirmed == 'True'){
        window.alert("Confirmed participant!");
        if (data[i].chosenhub == 'UIUC'){
        window.alert("UIUC participant!");
	    sumUIUC = sumUIUC + 1;
        }else if (data[i].chosenhub == 'APC'){
        sumAPC = sumAPC + 1;
        }else if (data[i].chosenhub == 'Princeton'){
        sumPrinceton = sumPrinceton + 1;
        }
   }
  }
   document.getElementById("APC_confirmed").innerHTML = "Confirmed APC participants: " + sumAPC;
   document.getElementById("UIUC_confirmed").innerHTML = "Confirmed UIUC participants: " + sumUIUC;
   document.getElementById("Princeton_confirmed").innerHTML = "Confirmed Princeton participants: " + sumPrinceton;
   document.getElementById("Remote_confirmed").innerHTML = "Confirmed remote participants: " + sumRemote;
   }
</script>

</body>

</html>
